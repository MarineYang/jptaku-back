# JPTaku Backend Server

ì¼ë³¸ì–´ í•™ìŠµ ì„œë¹„ìŠ¤ **JPTaku**ì˜ ë°±ì—”ë“œ API ì„œë²„ì…ë‹ˆë‹¤.

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ë¥˜ | ê¸°ìˆ  |
|------|------|
| **Language** | Go 1.24 |
| **Framework** | Gin |
| **Database** | PostgreSQL |
| **ORM** | GORM |
| **Cache** | Redis |
| **Auth** | JWT |

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
jptaku-back/
â”œâ”€â”€ cmd/                          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ main.go              # API ì„œë²„ ë©”ì¸
â”‚   â””â”€â”€ migrate/
â”‚       â””â”€â”€ main.go              # DB ë§ˆì´ê·¸ë ˆì´ì…˜ ë„êµ¬
â”‚
â”œâ”€â”€ internal/                     # ë‚´ë¶€ íŒ¨í‚¤ì§€ (ì™¸ë¶€ import ë¶ˆê°€)
â”‚   â”œâ”€â”€ api/                     # API í•¸ë“¤ëŸ¬ (Controller ë ˆì´ì–´)
â”‚   â”‚   â”œâ”€â”€ auth/               # ì¸ì¦ ê´€ë ¨ API
â”‚   â”‚   â”œâ”€â”€ chat/               # ëŒ€í™” ì„¸ì…˜ API
â”‚   â”‚   â”œâ”€â”€ feedback/           # í”¼ë“œë°± API
â”‚   â”‚   â”œâ”€â”€ learning/           # í•™ìŠµ ì§„í–‰ API
â”‚   â”‚   â”œâ”€â”€ sentences/          # ë¬¸ì¥ API
â”‚   â”‚   â””â”€â”€ user/               # ì‚¬ìš©ì API
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/                   # Redis ìºì‹œ
â”‚   â”‚   â””â”€â”€ redis.go
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                  # ì„¤ì • ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ config.go           # í™˜ê²½ë³€ìˆ˜ ë¡œë“œ
â”‚   â”‚   â””â”€â”€ database.go         # DB ì—°ê²° ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/              # HTTP ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â”œâ”€â”€ auth.go             # JWT ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ cors.go             # CORS ì„¤ì •
â”‚   â”‚   â””â”€â”€ logger.go           # ìš”ì²­ ë¡œê¹…
â”‚   â”‚
â”‚   â”œâ”€â”€ model/                   # ë°ì´í„° ëª¨ë¸ (Entity)
â”‚   â”‚   â”œâ”€â”€ chat.go             # ì±„íŒ… ì„¸ì…˜/ë©”ì‹œì§€
â”‚   â”‚   â”œâ”€â”€ daily_set.go        # ì¼ì¼ ë¬¸ì¥ ì„¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ feedback.go         # í”¼ë“œë°±
â”‚   â”‚   â”œâ”€â”€ learning.go         # í•™ìŠµ ì§„í–‰ ìƒí™©
â”‚   â”‚   â”œâ”€â”€ sentence.go         # ë¬¸ì¥/ë‹¨ì–´
â”‚   â”‚   â””â”€â”€ user.go             # ì‚¬ìš©ì/ì„¤ì •/ì˜¨ë³´ë”©
â”‚   â”‚
â”‚   â”œâ”€â”€ pkg/                     # ìœ í‹¸ë¦¬í‹° íŒ¨í‚¤ì§€
â”‚   â”‚   â”œâ”€â”€ error.go            # ì—ëŸ¬ ì •ì˜
â”‚   â”‚   â”œâ”€â”€ jwt.go              # JWT í† í° ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ response.go         # API ì‘ë‹µ í—¬í¼
â”‚   â”‚   â”œâ”€â”€ validator.go        # ìœ íš¨ì„± ê²€ì‚¬
â”‚   â”‚   â””â”€â”€ worker.go           # ë°±ê·¸ë¼ìš´ë“œ ì›Œì»¤
â”‚   â”‚
â”‚   â”œâ”€â”€ repository/              # ë°ì´í„° ì ‘ê·¼ ë ˆì´ì–´
â”‚   â”‚   â”œâ”€â”€ db_manager.go       # DB íŠ¸ëœì­ì…˜ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ chat_repo.go
â”‚   â”‚   â”œâ”€â”€ feedback_repo.go
â”‚   â”‚   â”œâ”€â”€ learning_repo.go
â”‚   â”‚   â”œâ”€â”€ sentence_repo.go
â”‚   â”‚   â””â”€â”€ user_repo.go
â”‚   â”‚
â”‚   â””â”€â”€ service/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë ˆì´ì–´
â”‚       â”œâ”€â”€ async_service.go    # ë¹„ë™ê¸° ì‘ì—… ì²˜ë¦¬
â”‚       â”œâ”€â”€ auth_service.go
â”‚       â”œâ”€â”€ chat_service.go
â”‚       â”œâ”€â”€ feedback_service.go
â”‚       â”œâ”€â”€ learning_service.go
â”‚       â”œâ”€â”€ sentence_service.go
â”‚       â””â”€â”€ user_service.go
â”‚
â”œâ”€â”€ env.example                  # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ go.mod                       # Go ëª¨ë“ˆ ì •ì˜
â”œâ”€â”€ go.sum                       # ì˜ì¡´ì„± ì²´í¬ì„¬
â””â”€â”€ Makefile                     # ë¹Œë“œ/ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```

## ğŸ— ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HTTP Request                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Middleware Layer                             â”‚
â”‚              (Logger â†’ CORS â†’ Auth)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Handler Layer                               â”‚
â”‚     (auth, user, sentences, learning, chat, feedback)            â”‚
â”‚              - ìš”ì²­ íŒŒì‹± / ì‘ë‹µ í¬ë§·íŒ…                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Service Layer                               â”‚
â”‚              - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬                                   â”‚
â”‚              - íŠ¸ëœì­ì…˜ ê´€ë¦¬                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Repository Layer                              â”‚
â”‚              - ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼                                    â”‚
â”‚              - CRUD ì‘ì—…                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PostgreSQL + Redis                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### Health Check
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/health` | ì„œë²„ ìƒíƒœ í™•ì¸ |

### Auth (ì¸ì¦) - `/api/auth`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/register` | íšŒì›ê°€ì… | âŒ |
| POST | `/login` | ë¡œê·¸ì¸ | âŒ |
| POST | `/refresh` | í† í° ê°±ì‹  | âŒ |
| POST | `/logout` | ë¡œê·¸ì•„ì›ƒ | âŒ |

### User (ì‚¬ìš©ì) - `/api/users`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/me` | ë‚´ ì •ë³´ ì¡°íšŒ | âœ… |
| PUT | `/me` | ë‚´ ì •ë³´ ìˆ˜ì • | âœ… |
| PUT | `/settings` | ì„¤ì • ìˆ˜ì • | âœ… |
| PUT | `/onboarding` | ì˜¨ë³´ë”© ì •ë³´ ìˆ˜ì • | âœ… |

### Sentences (ë¬¸ì¥) - `/api/sentences`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/daily` | ì˜¤ëŠ˜ì˜ 5ë¬¸ì¥ ì¡°íšŒ | âœ… |
| GET | `/:id` | ë¬¸ì¥ ìƒì„¸ ì¡°íšŒ | âœ… |
| GET | `/history` | í•™ìŠµ íˆìŠ¤í† ë¦¬ ì¡°íšŒ | âœ… |

### Learning (í•™ìŠµ) - `/api/learning`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/progress` | í•™ìŠµ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸ | âœ… |
| GET | `/today` | ì˜¤ëŠ˜ì˜ í•™ìŠµ ì§„í–‰ ìƒí™© | âœ… |
| GET | `/history` | í•™ìŠµ íˆìŠ¤í† ë¦¬ ì¡°íšŒ | âœ… |

### Chat (ëŒ€í™”) - `/api/chat`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/session` | ëŒ€í™” ì„¸ì…˜ ìƒì„± | âœ… |
| GET | `/session/:id` | ì„¸ì…˜ ìƒì„¸ ì¡°íšŒ | âœ… |
| POST | `/session/:id/end` | ì„¸ì…˜ ì¢…ë£Œ | âœ… |
| GET | `/sessions` | ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ | âœ… |

### Feedback (í”¼ë“œë°±) - `/api/feedback`
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/` | í”¼ë“œë°± ì œì¶œ | âœ… |
| GET | `/` | í”¼ë“œë°± ëª©ë¡ ì¡°íšŒ | âœ… |

## ğŸ“¦ ë°ì´í„° ëª¨ë¸

### User ê´€ë ¨
- **User**: ì‚¬ìš©ì ì •ë³´ (ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ì´ë¦„, OAuth ì œê³µì)
- **UserSettings**: ì‚¬ìš©ì ì„¤ì • (ì•Œë¦¼, ìŒì„± ì†ë„, ë¡œë§ˆì§€ í‘œì‹œ ë“±)
- **UserOnboarding**: ì˜¨ë³´ë”© ì •ë³´ (ë ˆë²¨, ê´€ì‹¬ì‚¬, í•™ìŠµ ëª©ì )

### Sentence ê´€ë ¨
- **Sentence**: ì¼ë³¸ì–´ ë¬¸ì¥ (ì¼ë³¸ì–´, í•œêµ­ì–´ ë²ˆì—­, ë¡œë§ˆì§€, ë ˆë²¨, íƒœê·¸)
- **SentenceDetail**: ë¬¸ì¥ ìƒì„¸ ì •ë³´ (ë‹¨ì–´ í’€ì´, ë¬¸ë²•, ì˜ˆë¬¸)
- **DailySentenceSet**: ì¼ì¼ ë¬¸ì¥ ì„¸íŠ¸ (ìœ ì €ë³„ ì˜¤ëŠ˜ì˜ 5ë¬¸ì¥)

### Learning ê´€ë ¨
- **LearningProgress**: í•™ìŠµ ì§„í–‰ ìƒí™© (ì´í•´, ë§í•˜ê¸°, í™•ì¸, ì•”ê¸° ì™„ë£Œ)

### Chat ê´€ë ¨
- **ChatSession**: ëŒ€í™” ì„¸ì…˜
- **ChatMessage**: ëŒ€í™” ë©”ì‹œì§€

### Feedback
- **Feedback**: ì‚¬ìš©ì í”¼ë“œë°±

## ğŸš€ ì‹œì‘í•˜ê¸°

### ìš”êµ¬ì‚¬í•­
- Go 1.24+
- PostgreSQL 15+
- Redis 7+

### í™˜ê²½ ì„¤ì •

```bash
# í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ìƒì„±
cp env.example .env

# .env íŒŒì¼ ìˆ˜ì •
vim .env
```

### í™˜ê²½ ë³€ìˆ˜

```env
# Server
SERVER_PORT=30001
GIN_MODE=debug          # debug, release, test

# Database (PostgreSQL)
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=jptaku
DB_SSLMODE=disable

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT
JWT_SECRET=your-super-secret-key
JWT_EXPIRATION_HOURS=24
```

### ì‹¤í–‰

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
make deps

# ê°œë°œ ì„œë²„ ì‹¤í–‰
make run

# ë˜ëŠ” Hot Reload (air í•„ìš”)
make run-dev

# ë¹Œë“œ
make build

# í…ŒìŠ¤íŠ¸
make test
```

### Makefile ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… |
|--------|------|
| `make run` | API ì„œë²„ ì‹¤í–‰ |
| `make run-dev` | Hot Reloadë¡œ ì‹¤í–‰ (air í•„ìš”) |
| `make build` | ë°”ì´ë„ˆë¦¬ ë¹Œë“œ |
| `make test` | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ |
| `make test-coverage` | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ |
| `make deps` | ì˜ì¡´ì„± ë‹¤ìš´ë¡œë“œ |
| `make tidy` | ì˜ì¡´ì„± ì •ë¦¬ |
| `make lint` | ë¦°í„° ì‹¤í–‰ |
| `make fmt` | ì½”ë“œ í¬ë§·íŒ… |
| `make migrate-up` | ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ |
| `make migrate-down` | ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡¤ë°± |
| `make seed` | ìƒ˜í”Œ ë°ì´í„° ì‚½ì… |
| `make docker-build` | Docker ì´ë¯¸ì§€ ë¹Œë“œ |
| `make docker-run` | Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰ |

## ğŸ” ì¸ì¦ ë°©ì‹

JWT (JSON Web Token) ê¸°ë°˜ ì¸ì¦ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
Authorization: Bearer <access_token>
```

- **Access Token**: API ì ‘ê·¼ìš© (ê¸°ë³¸ 24ì‹œê°„)
- **Refresh Token**: í† í° ê°±ì‹ ìš©

## ğŸ“ ì‘ë‹µ í˜•ì‹

### ì„±ê³µ ì‘ë‹µ
```json
{
  "success": true,
  "data": { ... }
}
```

### í˜ì´ì§€ë„¤ì´ì…˜ ì‘ë‹µ
```json
{
  "success": true,
  "data": [ ... ],
  "meta": {
    "page": 1,
    "per_page": 20,
    "total": 100
  }
}
```

### ì—ëŸ¬ ì‘ë‹µ
```json
{
  "success": false,
  "error": {
    "message": "ì—ëŸ¬ ë©”ì‹œì§€"
  }
}
```
## ğŸ“„ License
License by MarineYang